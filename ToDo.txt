Avesta ToDo List

■■■ 次のメジャーバージョンアップにて ■■■
・アイコン画像ファイル名を icon-SIZE.png に変更。
    全く同じ画像である menu.png と status.png の重複を無くしたい。
・form.xml の変更
    form.xml → system.xml / Display → System / Main → Panel / FolderList → Main

■■■ バグ ■■■

■ ファイル関連
[107] マイネットワークのプロパティが開けない。
[219] パスワード認証が必要なフォルダには入れない。
[636] 不必要に FDD へアクセスする。スリープ中のHDDも叩き起こしてしまうらしい。
[727] アーカイブXにて、圧縮ファイル内のフォルダが表示できない。 
[   ] ネットワークフォルダを開いた状態で、レジューム⇒復帰 すると、エラーが発生する場合がある。
[   ] 書き込み可能なCD/DVD-ROMドライブ内のフォルダ閲覧中に、パス移動ができなくなる場合がある。
[   ] 圧縮書庫などの仮想フォルダがツリーに表示されない。
[   ] ツリーが内容を含んでいなくても「＋」が表示される。
	⇒ いまのところ仕様。「＋」の有無を確かめるには、そのフォルダをスキャンする必要があり、時間がかかるため。

■ 操作関連
[572] チェックディスク中の終了すると、チェックディスクも終了してしまう。
[610] 起動時のコマンドラインとして -command を渡した場合の動作がおかしい。
[612] 連続して起動した場合、プロセスが２つ起動する。（対処法：スリープを挟むなど）
[665] コンテキストメニューからファイルやフォルダを新規作成した場合に、リネーム／フォーカス状態にならない。
        - 現状では、代わりに「ファイルの新規作成」ダイアログを使用してください。
        - ファイルの作成の前にShellNotificationを仕掛け、通知時に選択項目がなければ項目を選択。
[---] チェックボックスを途中から有効にした場合の挙動
        - スペースキーを押した場合のチェック状態のON/OFF切り替え動作について。
          誤：「チェックボックス無効」でウィンドウを開き、後から有効にすると、フォーカスされた項目のみON/OFFされる。
          正：「チェックボックス有効」でウィンドウを開くと、選択中のすべての項目がON/OFFされる。
[---] 並べて表示でのチェックボックス上でのダブルクリック
          誤：その項目が選択状態の場合に、ダブルクリックで起動してしまう。
          正：他の表示モードでは、チェック状態がON/OFFされるだけ。
[---] 並べて表示で項目を選択すると勝手に画面がスクロールする
        - 条件：並べて表示 / チェックボックスを表示 / 画面をスクロールさせた後に項目を選択

■ 表示関連
[---] ファイル名に"&"が使われていると、リンクメニューでニーモニックとして認識されてしまう。
[---] 「ドラッグ中にウィンドウの中身を表示しない」環境下で、ドラッグアイテムが半透明表示されない。
[---] 画面からはみ出る状態でメニュー開いた場合の位置がおかしい。
[---] えくすぽぜ で、アクセラレータ文字でパスなどが隠れてしまう。
[---] アドレスバーのドロップダウンボタンのホットトラッキングがおかしい。
[---] 新しくフォルダを開く際に、すでに1つでも開かれている場合はナビゲートサウンドが鳴らないが、初めの一つを開くときだけ鳴る。

■ 内部実装関連
[   ] 多くの種類のアイコンを表示すると、その他のアイコンが変化してしまう。アイコンキャッシュ溢れ？
[---] 起動中に環境変数が変更された場合、Avestaから起動するプログラムに変更が反映されない。Avesta自体を再起動すれば、反映されるようになる。
[---] 「隠しファイルの表示を切り替える」「表示モードを切り替える」と、カラムが初期化される。
[---] TYMED_HGLOBAL で取得したCIDAを解放すべきか否か、よくわからない。



■■■ 要望 ■■■

■ ファイラ 操作感
[557] ネットワークパス読み込みタイミングを遅らせる。現在、表示した瞬間に固まってしまう。
・シェルビューを作成する前に、別スレッドでフォルダの一覧を取得しておく。
　別スレッドなのでキャンセルできる上、キャッシングされるため、その後のビュー作成の高速化に役立つはず。
[615] タスクバーから復帰時、他のエクスプローラを取り込みたい。
・一般化すると、さまざまな場面でのhook機能を追加するということか。
[616] 二画面表示時、左右のフォルダを同期して移動したい。
[622] 隠しファイルの表示状態を、パスごとに保存する。
[633] Redo(やり直し) Ctrl+Zで「元に戻す」が使えますが、それを取り消す動作。
[726] メニュー項目の中クリックを、フォルダ上での中クリックと同様の動作にする。
[726] メニュー項目の右クリックはコンテキストメニューを出した。メニュー中にメニュー必須。
[---] 戻る、進む、上へ で、一度に複数段階移動できるようにする。
[---] アーカイブXを併用してる場合に、書庫の中の書庫を開くとエクスプローラが開いてしまう。
[---] マウスジェスチャをアイテム上でも有効にしたい。ただし、タイムアウトしたらドラッグに移行する。
[---] パンスクロール（IEでの中ボタン）
[---] アクティブのフォルダが分かりにくい。タブとフォルダの関係が分かりにくい。
　　　⇒ キャプションに名前を表示するようにしたので、優先度低下。色づけなどで対処するかも。

■ ファイラ 見た目
[619] メインウィンドウを移動させたときにプレビューウィンドウも一緒に移動するよう設定。
[630] タブをエクステンダーor多段で表示
[---] タブスタック。タブバーの部分が複数段になって、現在のタブが上へ持ち上がる。一番下に新しい段ができる。
[632] 初めて開いたフォルダのアイコンの並び順の指定
[---] フォルダ表示設定で「固定」機能。それ以降の変更は一時的なものとして、継続しない。
[---] アイテムの色分け。個別チェック（重要印など）と、フィルタチェック（EXEなど）の両対応。
[---] カラースキーマの変更。いっそのこと、偽Avalonでも実装するか？
[---] 奇数行、偶数行で色分け
[---] 複数画面を実行したら一時的にフォルダ表示を「アイコン（もしくは詳細表示や縮小版）」から「一覧」に自動で変更できるような機能
　⇒ 「項目数とウィンドウサイズを考慮し、表示モードを自動的に切り替える」に一般化可能？
[---] 同時に開くタブ数を固定できること。 
[---] タブの総表示幅がウィンドウ幅を超えた際、スクロール / 複数行 / 縮小して画面幅に収める など。

■ 拡張機能
[---] ExecuteコマンドとNavigateコマンドの統合。
[586] エクスプローラ画像ビューア型表示の取り込み
[---] エクスプローラ検索ペインの取り込み
[621] Windows デスクトップ サーチへの対応 （MSNツールバー付属）
[640] ファイルにマークを付けたい（ファイルに対する付加情報を保持できるように）
[---] ファイルにメタデータを付与できるようにする
    一長一短あり。
    ・ファイル埋め込み
        追従性に優れるが、ファイル形式に依存する。
        （例）jpgのコメントフィールド
    ・NTFS alternative stream
        ファイルの圧縮+解凍や、他環境に移した場合に情報が失われる。
    ・別ファイル保存
        環境を問わないが、関連を見失う危険性がある。
        （例）ファイル全体のMD5をキーにして、別ファイルにメタ情報を格納する。
[---] ファイル整理機能
    ・インクリメンタルサーチっぽいファイル振り分け
        キーワード→振り分け先を登録し、キーワードを入力するとファイルが移動される。
[---] リネームの改良全般。エラーをまとめて表示する。
[---] リンクバー、ブックマークを使いやすくする。
・XMLの出力そのものは実装済みなので、十分可能。
[---] いろいろな条件で重複ファイルの検索
・多画面表示してファイル同士を比較する。
・「異なるファイルを選択」というのもあったらいいかも。
　 単純なフォルダの同期のような意味？ 「表示中のフォルダを全て同期させる」みたいな。
[---] ファイルがドロップされたときに メニューを出す。
      コピーか移動の選択、タイムスタンプを比較して上書きコピーなど。
[---] ツリーを自動的にフォルダに同期させる状態で、ツリーをキーボードで操作するとカーソル移動ごとに同期してしまい、うざい。
[---] ツリーからのドラッグ。
[---] ツリーの自動更新、変更反映
[---] ツリーの同期を、非同期に処理する …… マルチスレッド化
[---] ツリーへドロップする場合の、自動スクロール、自動展開。
[---] リンクバーの更新、変更反映。
[---] リンクバーにドラッグした時に、リンク先が自動的にタブが追加される（タブにドラッグした時のように開く）
[---] コマンド入力用ペイン
[---] SHFileOperation() の UNDO の仕方。また、UNDO 時に何が起こるかという情報の取得方法。
[---] サブエントリがある場合のShellNewのテンプレートファイルの特定の方法。

■ カスタマイズ
[658] ホイールジェスチャの改良。「ホイールを回すごとに切り替わる」を可能に。
[728] タブをクリックしたときの動作をカスタマイズしたい。
[---] タブの右クリックメニュー
[---] ファイルを選択してのコンテキストメニュー
[---] フォルダの何も無いところでの右クリックメニュー
[---] タブを下部に表示したい（⇒ タブ部をマウスドラッグで、上下左右にdockできるようにすればいいかな？）
[---] メニューにファイルの新規作成リストを追加する。
[---] ツールバーの機能が増え、リンクバーとの差が少なくなってきた。統合できるか？

■ その他
・Avesta自体に影響を与えられるコマンド（＝DLLプラグイン）を登録できるようにする。
・コマンドの直交性がない。
　　⇒ "target" - "verb" - "args" の3段構成
・キー入力エミュレーションコマンドの一般化
    ⇒ TARGET.Key(Ctrl+Enter) などと書けるようにする
・DDEなどのWindows標準プロトコルへの対応。
・履歴バー。履歴や使用頻度に応じて自動的に更新されるリンクバー。ここへD&Dできるようにする。



■■■ 仕様 or 対応できない ■■■

■ 2000や9xで動きません。
　　⇒ シェルビューの実装がXPと大幅に異なるため、対応をあきらめました。
　　　 もし、挑戦して下さる方がいらしたら、ご連絡ください。

■ Windowsの制限またはバグにより、対応が難しいもの
・環境によっては、たまにファイル順がぐちゃぐちゃになる。更新するまでファイルが見えなくなる。
・ドラッグ＆ドロップでファイルのコピー／移動中にドロップ先を閉じると、内部でアクセス違反している。
・外部エクスプローラへドラッグ＆ドロップすると、ファイルのコピー／移動が終了するまでアプリケーション全体が操作を受け付けなくなる。
・アプリケーション内の他のフォルダへドラッグ＆ドロップすると、ドラッグ元のフォルダをマウスで操作できなくなる。（キーボードなら操作可能）
　　⇒ もしかすると、ICopyHook あたりで回避可能かも？
・壁紙機能を強化して欲しい。タイリング以外の並べ方／メモリ喰いすぎ／描画が重くなる。
・ソート時に第二優先候補を選択したい。
・チェック済みか否かで並び替えたい。

■ 仕様（このアプリケーションの設計思想などにより、対処するつもりが無いもの）
・高機能なファイルコピー／移動がしたい（自動リネーム、更新された項目のみなど）。
　　⇒ エクスプローラでも使えたほうが良い機能は、シェルエクステンションなどで実現すべきと考えています。
・圧縮書庫をフォルダとして扱いたい。
　　⇒ zipfldr.dll とコンパチなシェルエクステンションを導入してください。
　　　 アーカイブX : http://www.group-finity.com/products/tools/ArchiveX/ は、zipfldr.dll よりも優れたアーカイバです。
・WSH に対応して欲しい。
　　⇒ Python で我慢してください。

■ 原因不明・環境依存
？右クリックすると「lspcul.dllがありません」というエラーが出る。一度でも「マイコンピュータ」を開けば起こらない。
？ファイルを削除する、フォルダを閉じるなどの操作時に、ごくたまに数秒間応答しなくなる環境がある。
